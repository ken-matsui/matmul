/* Autogenerated file. Do not edit manually. */

#include "Blis.h"

#include <stdint.h>  // for uint8_t
#include <stdlib.h>  // for free, malloc

void Blis_1_1_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_1_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_1_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_1_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_1_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_1_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_1_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_1_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_1_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_1_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_1_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_1_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_2_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_2_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_2_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_2_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_2_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_2_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_2_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_2_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_2_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_2_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_2_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_2_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_4_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_4_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_4_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_4_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_4_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_4_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_4_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_4_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_4_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_4_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_4_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_4_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_8_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_8_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_8_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_8_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_8_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_8_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_8_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_8_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_8_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_8_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_8_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_8_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_16_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_16_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_16_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_16_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_16_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_16_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_16_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_16_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_16_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_16_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_16_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_16_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_32_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_32_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_32_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_32_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_32_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_32_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_32_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_32_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_32_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_32_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_32_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_32_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_64_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_64_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_64_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_64_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_64_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_64_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_64_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_64_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_64_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_64_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_64_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_64_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_128_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_128_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_128_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_128_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_128_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_128_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_128_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_128_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_128_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_128_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_128_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_128_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_256_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_256_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_256_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_256_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_256_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_256_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_256_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_256_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_256_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_256_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_256_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_256_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_512_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_512_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_512_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_512_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_512_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_512_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_512_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_512_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_512_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_512_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_512_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_512_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_1024_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_1024_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_1024_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_1024_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_1024_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_1024_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_1024_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_1024_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_1024_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_1024_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_1024_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_1024_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_2048_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_2048_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_2048_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_2048_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_2048_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_2048_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_2048_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_2048_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_2048_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_2048_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_2048_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1_2048_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 1) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 1; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_1_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_1_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_1_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_1_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_1_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_1_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_1_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_1_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_1_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_1_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_1_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_1_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_2_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_2_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_2_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_2_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_2_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_2_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_2_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_2_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_2_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_2_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_2_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_2_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_4_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_4_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_4_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_4_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_4_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_4_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_4_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_4_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_4_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_4_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_4_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_4_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_8_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_8_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_8_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_8_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_8_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_8_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_8_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_8_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_8_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_8_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_8_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_8_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_16_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_16_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_16_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_16_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_16_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_16_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_16_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_16_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_16_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_16_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_16_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_16_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_32_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_32_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_32_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_32_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_32_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_32_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_32_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_32_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_32_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_32_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_32_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_32_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_64_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_64_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_64_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_64_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_64_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_64_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_64_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_64_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_64_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_64_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_64_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_64_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_128_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_128_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_128_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_128_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_128_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_128_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_128_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_128_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_128_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_128_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_128_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_128_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_256_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_256_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_256_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_256_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_256_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_256_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_256_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_256_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_256_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_256_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_256_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_256_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_512_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_512_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_512_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_512_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_512_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_512_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_512_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_512_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_512_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_512_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_512_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_512_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_1024_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_1024_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_1024_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_1024_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_1024_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_1024_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_1024_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_1024_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_1024_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_1024_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_1024_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_1024_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_2048_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_2048_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_2048_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_2048_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_2048_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_2048_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_2048_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_2048_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_2048_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_2048_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_2048_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2_2048_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 2) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 2; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_1_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_1_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_1_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_1_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_1_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_1_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_1_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_1_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_1_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_1_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_1_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_1_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_2_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_2_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_2_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_2_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_2_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_2_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_2_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_2_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_2_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_2_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_2_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_2_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_4_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_4_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_4_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_4_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_4_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_4_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_4_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_4_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_4_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_4_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_4_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_4_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_8_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_8_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_8_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_8_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_8_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_8_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_8_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_8_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_8_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_8_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_8_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_8_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_16_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_16_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_16_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_16_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_16_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_16_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_16_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_16_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_16_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_16_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_16_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_16_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_32_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_32_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_32_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_32_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_32_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_32_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_32_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_32_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_32_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_32_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_32_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_32_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_64_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_64_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_64_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_64_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_64_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_64_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_64_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_64_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_64_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_64_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_64_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_64_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_128_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_128_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_128_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_128_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_128_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_128_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_128_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_128_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_128_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_128_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_128_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_128_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_256_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_256_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_256_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_256_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_256_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_256_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_256_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_256_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_256_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_256_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_256_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_256_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_512_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_512_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_512_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_512_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_512_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_512_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_512_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_512_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_512_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_512_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_512_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_512_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_1024_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_1024_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_1024_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_1024_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_1024_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_1024_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_1024_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_1024_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_1024_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_1024_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_1024_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_1024_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_2048_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_2048_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_2048_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_2048_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_2048_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_2048_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_2048_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_2048_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_2048_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_2048_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_2048_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_4_2048_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 4) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(4 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 4; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 4; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_1_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_1_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_1_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_1_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_1_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_1_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_1_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_1_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_1_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_1_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_1_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_1_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_2_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_2_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_2_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_2_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_2_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_2_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_2_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_2_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_2_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_2_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_2_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_2_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_4_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_4_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_4_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_4_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_4_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_4_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_4_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_4_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_4_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_4_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_4_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_4_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_8_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_8_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_8_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_8_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_8_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_8_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_8_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_8_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_8_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_8_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_8_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_8_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_16_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_16_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_16_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_16_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_16_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_16_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_16_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_16_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_16_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_16_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_16_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_16_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_32_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_32_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_32_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_32_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_32_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_32_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_32_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_32_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_32_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_32_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_32_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_32_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_64_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_64_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_64_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_64_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_64_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_64_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_64_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_64_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_64_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_64_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_64_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_64_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_128_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_128_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_128_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_128_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_128_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_128_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_128_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_128_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_128_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_128_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_128_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_128_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_256_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_256_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_256_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_256_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_256_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_256_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_256_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_256_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_256_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_256_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_256_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_256_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_512_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_512_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_512_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_512_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_512_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_512_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_512_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_512_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_512_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_512_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_512_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_512_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_1024_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_1024_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_1024_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_1024_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_1024_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_1024_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_1024_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_1024_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_1024_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_1024_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_1024_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_1024_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_2048_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_2048_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_2048_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_2048_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_2048_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_2048_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_2048_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_2048_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_2048_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_2048_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_2048_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_8_2048_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 8) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(8 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 8; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 8; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_1_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_1_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_1_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_1_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_1_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_1_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_1_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_1_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_1_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_1_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_1_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_1_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_2_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_2_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_2_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_2_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_2_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_2_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_2_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_2_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_2_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_2_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_2_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_2_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_4_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_4_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_4_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_4_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_4_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_4_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_4_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_4_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_4_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_4_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_4_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_4_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_8_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_8_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_8_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_8_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_8_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_8_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_8_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_8_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_8_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_8_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_8_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_8_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_16_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_16_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_16_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_16_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_16_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_16_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_16_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_16_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_16_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_16_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_16_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_16_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_32_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_32_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_32_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_32_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_32_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_32_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_32_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_32_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_32_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_32_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_32_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_32_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_64_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_64_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_64_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_64_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_64_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_64_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_64_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_64_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_64_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_64_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_64_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_64_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_128_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_128_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_128_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_128_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_128_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_128_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_128_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_128_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_128_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_128_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_128_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_128_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_256_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_256_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_256_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_256_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_256_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_256_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_256_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_256_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_256_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_256_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_256_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_256_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_512_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_512_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_512_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_512_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_512_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_512_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_512_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_512_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_512_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_512_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_512_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_512_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_1024_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_1024_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_1024_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_1024_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_1024_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_1024_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_1024_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_1024_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_1024_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_1024_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_1024_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_1024_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_2048_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_2048_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_2048_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_2048_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_2048_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_2048_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_2048_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_2048_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_2048_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_2048_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_2048_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_16_2048_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 16) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(16 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 16; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 16; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_1_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_1_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_1_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_1_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_1_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_1_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_1_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_1_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_1_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_1_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_1_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_1_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_2_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_2_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_2_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_2_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_2_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_2_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_2_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_2_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_2_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_2_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_2_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_2_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_4_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_4_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_4_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_4_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_4_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_4_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_4_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_4_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_4_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_4_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_4_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_4_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_8_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_8_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_8_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_8_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_8_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_8_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_8_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_8_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_8_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_8_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_8_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_8_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_16_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_16_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_16_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_16_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_16_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_16_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_16_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_16_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_16_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_16_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_16_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_16_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_32_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_32_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_32_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_32_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_32_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_32_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_32_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_32_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_32_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_32_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_32_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_32_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_64_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_64_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_64_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_64_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_64_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_64_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_64_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_64_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_64_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_64_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_64_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_64_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_128_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_128_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_128_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_128_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_128_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_128_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_128_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_128_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_128_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_128_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_128_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_128_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_256_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_256_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_256_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_256_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_256_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_256_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_256_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_256_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_256_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_256_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_256_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_256_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_512_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_512_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_512_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_512_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_512_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_512_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_512_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_512_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_512_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_512_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_512_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_512_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_1024_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_1024_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_1024_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_1024_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_1024_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_1024_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_1024_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_1024_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_1024_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_1024_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_1024_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_1024_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_2048_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_2048_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_2048_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_2048_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_2048_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_2048_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_2048_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_2048_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_2048_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_2048_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_2048_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_32_2048_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 32) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(32 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 32; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 32; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_1_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_1_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_1_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_1_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_1_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_1_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_1_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_1_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_1_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_1_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_1_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_1_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_2_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_2_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_2_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_2_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_2_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_2_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_2_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_2_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_2_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_2_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_2_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_2_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_4_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_4_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_4_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_4_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_4_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_4_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_4_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_4_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_4_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_4_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_4_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_4_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_8_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_8_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_8_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_8_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_8_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_8_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_8_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_8_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_8_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_8_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_8_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_8_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_16_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_16_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_16_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_16_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_16_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_16_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_16_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_16_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_16_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_16_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_16_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_16_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_32_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_32_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_32_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_32_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_32_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_32_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_32_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_32_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_32_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_32_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_32_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_32_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_64_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_64_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_64_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_64_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_64_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_64_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_64_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_64_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_64_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_64_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_64_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_64_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_128_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_128_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_128_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_128_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_128_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_128_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_128_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_128_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_128_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_128_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_128_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_128_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_256_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_256_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_256_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_256_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_256_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_256_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_256_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_256_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_256_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_256_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_256_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_256_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_512_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_512_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_512_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_512_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_512_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_512_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_512_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_512_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_512_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_512_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_512_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_512_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_1024_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_1024_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_1024_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_1024_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_1024_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_1024_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_1024_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_1024_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_1024_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_1024_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_1024_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_1024_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_2048_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_2048_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_2048_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_2048_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_2048_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_2048_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_2048_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_2048_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_2048_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_2048_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_2048_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_64_2048_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 64) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(64 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 64; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 64; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_1_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_1_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_1_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_1_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_1_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_1_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_1_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_1_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_1_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_1_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_1_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_1_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_2_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_2_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_2_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_2_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_2_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_2_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_2_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_2_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_2_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_2_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_2_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_2_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_4_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_4_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_4_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_4_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_4_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_4_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_4_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_4_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_4_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_4_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_4_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_4_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_8_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_8_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_8_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_8_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_8_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_8_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_8_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_8_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_8_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_8_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_8_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_8_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_16_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_16_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_16_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_16_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_16_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_16_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_16_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_16_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_16_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_16_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_16_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_16_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_32_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_32_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_32_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_32_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_32_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_32_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_32_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_32_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_32_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_32_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_32_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_32_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_64_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_64_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_64_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_64_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_64_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_64_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_64_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_64_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_64_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_64_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_64_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_64_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_128_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_128_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_128_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_128_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_128_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_128_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_128_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_128_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_128_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_128_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_128_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_128_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_256_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_256_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_256_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_256_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_256_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_256_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_256_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_256_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_256_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_256_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_256_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_256_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_512_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_512_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_512_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_512_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_512_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_512_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_512_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_512_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_512_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_512_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_512_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_512_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_1024_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_1024_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_1024_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_1024_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_1024_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_1024_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_1024_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_1024_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_1024_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_1024_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_1024_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_1024_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_2048_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_2048_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_2048_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_2048_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_2048_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_2048_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_2048_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_2048_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_2048_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_2048_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_2048_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_128_2048_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 128) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(128 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 128; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 128; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_1_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_1_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_1_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_1_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_1_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_1_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_1_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_1_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_1_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_1_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_1_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_1_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_2_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_2_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_2_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_2_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_2_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_2_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_2_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_2_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_2_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_2_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_2_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_2_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_4_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_4_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_4_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_4_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_4_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_4_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_4_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_4_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_4_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_4_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_4_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_4_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_8_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_8_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_8_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_8_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_8_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_8_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_8_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_8_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_8_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_8_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_8_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_8_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_16_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_16_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_16_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_16_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_16_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_16_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_16_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_16_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_16_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_16_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_16_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_16_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_32_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_32_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_32_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_32_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_32_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_32_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_32_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_32_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_32_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_32_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_32_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_32_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_64_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_64_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_64_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_64_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_64_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_64_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_64_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_64_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_64_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_64_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_64_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_64_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_128_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_128_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_128_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_128_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_128_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_128_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_128_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_128_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_128_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_128_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_128_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_128_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_256_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_256_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_256_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_256_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_256_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_256_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_256_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_256_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_256_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_256_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_256_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_256_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_512_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_512_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_512_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_512_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_512_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_512_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_512_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_512_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_512_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_512_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_512_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_512_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_1024_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_1024_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_1024_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_1024_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_1024_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_1024_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_1024_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_1024_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_1024_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_1024_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_1024_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_1024_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_2048_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_2048_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_2048_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_2048_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_2048_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_2048_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_2048_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_2048_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_2048_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_2048_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_2048_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_256_2048_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 256) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(256 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 256; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 256; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_1_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_1_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_1_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_1_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_1_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_1_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_1_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_1_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_1_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_1_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_1_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_1_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_2_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_2_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_2_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_2_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_2_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_2_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_2_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_2_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_2_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_2_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_2_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_2_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_4_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_4_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_4_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_4_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_4_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_4_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_4_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_4_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_4_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_4_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_4_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_4_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_8_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_8_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_8_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_8_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_8_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_8_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_8_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_8_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_8_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_8_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_8_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_8_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_16_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_16_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_16_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_16_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_16_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_16_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_16_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_16_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_16_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_16_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_16_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_16_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_32_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_32_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_32_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_32_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_32_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_32_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_32_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_32_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_32_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_32_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_32_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_32_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_64_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_64_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_64_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_64_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_64_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_64_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_64_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_64_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_64_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_64_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_64_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_64_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_128_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_128_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_128_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_128_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_128_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_128_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_128_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_128_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_128_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_128_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_128_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_128_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_256_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_256_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_256_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_256_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_256_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_256_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_256_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_256_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_256_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_256_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_256_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_256_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_512_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_512_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_512_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_512_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_512_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_512_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_512_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_512_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_512_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_512_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_512_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_512_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_1024_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_1024_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_1024_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_1024_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_1024_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_1024_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_1024_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_1024_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_1024_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_1024_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_1024_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_1024_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_2048_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_2048_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_2048_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_2048_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_2048_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_2048_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_2048_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_2048_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_2048_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_2048_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_2048_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_512_2048_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 512) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(512 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 512; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 512; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_1_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_1_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_1_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_1_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_1_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_1_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_1_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_1_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_1_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_1_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_1_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_1_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_2_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_2_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_2_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_2_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_2_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_2_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_2_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_2_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_2_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_2_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_2_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_2_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_4_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_4_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_4_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_4_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_4_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_4_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_4_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_4_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_4_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_4_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_4_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_4_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_8_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_8_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_8_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_8_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_8_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_8_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_8_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_8_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_8_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_8_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_8_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_8_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_16_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_16_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_16_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_16_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_16_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_16_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_16_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_16_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_16_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_16_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_16_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_16_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_32_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_32_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_32_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_32_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_32_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_32_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_32_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_32_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_32_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_32_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_32_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_32_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_64_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_64_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_64_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_64_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_64_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_64_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_64_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_64_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_64_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_64_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_64_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_64_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_128_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_128_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_128_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_128_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_128_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_128_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_128_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_128_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_128_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_128_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_128_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_128_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_256_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_256_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_256_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_256_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_256_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_256_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_256_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_256_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_256_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_256_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_256_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_256_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_512_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_512_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_512_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_512_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_512_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_512_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_512_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_512_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_512_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_512_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_512_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_512_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_1024_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_1024_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_1024_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_1024_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_1024_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_1024_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_1024_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_1024_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_1024_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_1024_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_1024_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_1024_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_2048_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_2048_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_2048_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_2048_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_2048_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_2048_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_2048_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_2048_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_2048_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_2048_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_2048_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_1024_2048_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 1024) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(1024 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 1024; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 1024; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_1_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_1_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_1_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_1_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_1_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_1_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_1_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_1_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_1_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_1_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_1_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_1_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 1 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 1; ++jj) {
            B_block[(pp - p) * 1 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 1 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_2_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_2_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_2_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_2_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_2_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_2_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_2_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_2_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_2_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_2_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_2_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_2_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 2 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 2; ++jj) {
            B_block[(pp - p) * 2 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 2 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_4_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_4_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_4_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_4_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_4_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_4_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_4_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_4_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_4_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_4_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_4_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_4_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 4) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 4 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 4; ++jj) {
            B_block[(pp - p) * 4 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 4; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 4 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_8_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_8_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_8_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_8_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_8_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_8_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_8_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_8_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_8_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_8_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_8_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_8_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 8) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 8 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 8; ++jj) {
            B_block[(pp - p) * 8 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 8; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 8 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_16_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_16_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_16_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_16_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_16_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_16_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_16_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_16_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_16_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_16_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_16_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_16_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 16) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 16 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 16; ++jj) {
            B_block[(pp - p) * 16 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 16; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 16 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_32_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_32_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_32_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_32_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_32_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_32_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_32_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_32_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_32_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_32_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_32_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_32_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 32) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 32 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 32; ++jj) {
            B_block[(pp - p) * 32 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 32; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 32 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_64_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_64_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_64_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_64_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_64_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_64_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_64_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_64_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_64_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_64_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_64_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_64_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 64) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 64 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 64; ++jj) {
            B_block[(pp - p) * 64 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 64; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 64 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_128_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_128_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_128_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_128_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_128_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_128_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_128_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_128_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_128_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_128_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_128_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_128_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 128) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 128 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 128; ++jj) {
            B_block[(pp - p) * 128 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 128; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 128 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_256_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_256_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_256_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_256_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_256_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_256_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_256_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_256_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_256_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_256_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_256_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_256_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 256) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 256 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 256; ++jj) {
            B_block[(pp - p) * 256 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 256; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 256 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_512_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_512_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_512_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_512_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_512_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_512_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_512_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_512_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_512_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_512_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_512_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_512_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 512) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 512 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 512; ++jj) {
            B_block[(pp - p) * 512 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 512; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 512 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_1024_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_1024_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_1024_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_1024_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_1024_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_1024_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_1024_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_1024_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_1024_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_1024_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_1024_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_1024_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 1024) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 1024 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 1024; ++jj) {
            B_block[(pp - p) * 1024 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 1024; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 1024 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_2048_1(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 1) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 1 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 1; ++pp) {
            A_block[(ii - i) * 1 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_2048_2(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 2) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 2 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 2; ++pp) {
            A_block[(ii - i) * 2 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_2048_4(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 4) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 4 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 4; ++pp) {
            A_block[(ii - i) * 4 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(4 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 4; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 4; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 4 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_2048_8(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 8) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 8 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 8; ++pp) {
            A_block[(ii - i) * 8 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(8 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 8; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 8; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 8 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_2048_16(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 16) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 16 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 16; ++pp) {
            A_block[(ii - i) * 16 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(16 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 16; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 16; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 16 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_2048_32(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 32) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 32 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 32; ++pp) {
            A_block[(ii - i) * 32 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(32 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 32; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 32; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 32 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_2048_64(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 64) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 64 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 64; ++pp) {
            A_block[(ii - i) * 64 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(64 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 64; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 64; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 64 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_2048_128(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 128) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 128 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 128; ++pp) {
            A_block[(ii - i) * 128 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(128 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 128; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 128; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 128 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_2048_256(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 256) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 256 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 256; ++pp) {
            A_block[(ii - i) * 256 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(256 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 256; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 256; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 256 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_2048_512(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 512) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 512 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 512; ++pp) {
            A_block[(ii - i) * 512 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(512 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 512; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 512; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 512 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_2048_1024(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 1024) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 1024 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 1024; ++pp) {
            A_block[(ii - i) * 1024 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(1024 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 1024; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 1024; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 1024 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

void Blis_2048_2048_2048(uint8_t *A, uint8_t *B, uint8_t *restrict C) {
  for (int j = 0; j < N; j += 2048) {
    for (int p = 0; p < K; p += 2048) {
      for (int i = 0; i < M; i += 2048) {
        // Pack into A
        uint8_t *restrict A_block =
            (uint8_t *)malloc(2048 * 2048 * sizeof(uint8_t));
        for (int ii = i; ii < i + 2048; ++ii) {
          for (int pp = p; pp < p + 2048; ++pp) {
            A_block[(ii - i) * 2048 + (pp - p)] = A[pp * N + ii];
          }
        }

        // Pack into B
        uint8_t *restrict B_block =
            (uint8_t *)malloc(2048 * 2048 * sizeof(uint8_t));
        for (int pp = p; pp < p + 2048; ++pp) {
          for (int jj = j; jj < j + 2048; ++jj) {
            B_block[(pp - p) * 2048 + (jj - j)] = B[pp * N + jj];
          }
        }

        // Macrokernel
        for (int jj = 0; jj < 2048; ++jj) {
          for (int ii = 0; ii < 2048; ++ii) {
            // Microkernel
            for (int pp = 0; pp < 2048; ++pp) {
              C[(i + ii) * N + (j + jj)] +=
                  A_block[ii * 2048 + pp] * B_block[pp * 2048 + jj];
            }
          }
        }

        free(A_block);
        free(B_block);
      }
    }
  }
}

